// Code generated by ent, DO NOT EDIT.

package ent

import (
	"context"
	"errors"
	"fmt"
	"github.com/go-tangra/go-tangra-portal/app/lcm/service/internal/data/ent/issuer"
	"github.com/go-tangra/go-tangra-portal/app/lcm/service/internal/data/ent/predicate"
	"github.com/go-tangra/go-tangra-portal/app/lcm/service/internal/data/ent/selfsignedissuer"
	"time"

	"entgo.io/ent/dialect/sql"
	"entgo.io/ent/dialect/sql/sqlgraph"
	"entgo.io/ent/dialect/sql/sqljson"
	"entgo.io/ent/schema/field"
)

// SelfSignedIssuerUpdate is the builder for updating SelfSignedIssuer entities.
type SelfSignedIssuerUpdate struct {
	config
	hooks     []Hook
	mutation  *SelfSignedIssuerMutation
	modifiers []func(*sql.UpdateBuilder)
}

// Where appends a list predicates to the SelfSignedIssuerUpdate builder.
func (_u *SelfSignedIssuerUpdate) Where(ps ...predicate.SelfSignedIssuer) *SelfSignedIssuerUpdate {
	_u.mutation.Where(ps...)
	return _u
}

// SetCommonName sets the "common_name" field.
func (_u *SelfSignedIssuerUpdate) SetCommonName(v string) *SelfSignedIssuerUpdate {
	_u.mutation.SetCommonName(v)
	return _u
}

// SetNillableCommonName sets the "common_name" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdate) SetNillableCommonName(v *string) *SelfSignedIssuerUpdate {
	if v != nil {
		_u.SetCommonName(*v)
	}
	return _u
}

// SetDNSNames sets the "dns_names" field.
func (_u *SelfSignedIssuerUpdate) SetDNSNames(v []string) *SelfSignedIssuerUpdate {
	_u.mutation.SetDNSNames(v)
	return _u
}

// AppendDNSNames appends value to the "dns_names" field.
func (_u *SelfSignedIssuerUpdate) AppendDNSNames(v []string) *SelfSignedIssuerUpdate {
	_u.mutation.AppendDNSNames(v)
	return _u
}

// ClearDNSNames clears the value of the "dns_names" field.
func (_u *SelfSignedIssuerUpdate) ClearDNSNames() *SelfSignedIssuerUpdate {
	_u.mutation.ClearDNSNames()
	return _u
}

// SetIPAddresses sets the "ip_addresses" field.
func (_u *SelfSignedIssuerUpdate) SetIPAddresses(v []string) *SelfSignedIssuerUpdate {
	_u.mutation.SetIPAddresses(v)
	return _u
}

// AppendIPAddresses appends value to the "ip_addresses" field.
func (_u *SelfSignedIssuerUpdate) AppendIPAddresses(v []string) *SelfSignedIssuerUpdate {
	_u.mutation.AppendIPAddresses(v)
	return _u
}

// ClearIPAddresses clears the value of the "ip_addresses" field.
func (_u *SelfSignedIssuerUpdate) ClearIPAddresses() *SelfSignedIssuerUpdate {
	_u.mutation.ClearIPAddresses()
	return _u
}

// SetCaCommonName sets the "ca_common_name" field.
func (_u *SelfSignedIssuerUpdate) SetCaCommonName(v string) *SelfSignedIssuerUpdate {
	_u.mutation.SetCaCommonName(v)
	return _u
}

// SetNillableCaCommonName sets the "ca_common_name" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdate) SetNillableCaCommonName(v *string) *SelfSignedIssuerUpdate {
	if v != nil {
		_u.SetCaCommonName(*v)
	}
	return _u
}

// SetCaOrganization sets the "ca_organization" field.
func (_u *SelfSignedIssuerUpdate) SetCaOrganization(v string) *SelfSignedIssuerUpdate {
	_u.mutation.SetCaOrganization(v)
	return _u
}

// SetNillableCaOrganization sets the "ca_organization" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdate) SetNillableCaOrganization(v *string) *SelfSignedIssuerUpdate {
	if v != nil {
		_u.SetCaOrganization(*v)
	}
	return _u
}

// ClearCaOrganization clears the value of the "ca_organization" field.
func (_u *SelfSignedIssuerUpdate) ClearCaOrganization() *SelfSignedIssuerUpdate {
	_u.mutation.ClearCaOrganization()
	return _u
}

// SetCaOrganizationalUnit sets the "ca_organizational_unit" field.
func (_u *SelfSignedIssuerUpdate) SetCaOrganizationalUnit(v string) *SelfSignedIssuerUpdate {
	_u.mutation.SetCaOrganizationalUnit(v)
	return _u
}

// SetNillableCaOrganizationalUnit sets the "ca_organizational_unit" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdate) SetNillableCaOrganizationalUnit(v *string) *SelfSignedIssuerUpdate {
	if v != nil {
		_u.SetCaOrganizationalUnit(*v)
	}
	return _u
}

// ClearCaOrganizationalUnit clears the value of the "ca_organizational_unit" field.
func (_u *SelfSignedIssuerUpdate) ClearCaOrganizationalUnit() *SelfSignedIssuerUpdate {
	_u.mutation.ClearCaOrganizationalUnit()
	return _u
}

// SetCaCountry sets the "ca_country" field.
func (_u *SelfSignedIssuerUpdate) SetCaCountry(v string) *SelfSignedIssuerUpdate {
	_u.mutation.SetCaCountry(v)
	return _u
}

// SetNillableCaCountry sets the "ca_country" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdate) SetNillableCaCountry(v *string) *SelfSignedIssuerUpdate {
	if v != nil {
		_u.SetCaCountry(*v)
	}
	return _u
}

// ClearCaCountry clears the value of the "ca_country" field.
func (_u *SelfSignedIssuerUpdate) ClearCaCountry() *SelfSignedIssuerUpdate {
	_u.mutation.ClearCaCountry()
	return _u
}

// SetCaProvince sets the "ca_province" field.
func (_u *SelfSignedIssuerUpdate) SetCaProvince(v string) *SelfSignedIssuerUpdate {
	_u.mutation.SetCaProvince(v)
	return _u
}

// SetNillableCaProvince sets the "ca_province" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdate) SetNillableCaProvince(v *string) *SelfSignedIssuerUpdate {
	if v != nil {
		_u.SetCaProvince(*v)
	}
	return _u
}

// ClearCaProvince clears the value of the "ca_province" field.
func (_u *SelfSignedIssuerUpdate) ClearCaProvince() *SelfSignedIssuerUpdate {
	_u.mutation.ClearCaProvince()
	return _u
}

// SetCaLocality sets the "ca_locality" field.
func (_u *SelfSignedIssuerUpdate) SetCaLocality(v string) *SelfSignedIssuerUpdate {
	_u.mutation.SetCaLocality(v)
	return _u
}

// SetNillableCaLocality sets the "ca_locality" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdate) SetNillableCaLocality(v *string) *SelfSignedIssuerUpdate {
	if v != nil {
		_u.SetCaLocality(*v)
	}
	return _u
}

// ClearCaLocality clears the value of the "ca_locality" field.
func (_u *SelfSignedIssuerUpdate) ClearCaLocality() *SelfSignedIssuerUpdate {
	_u.mutation.ClearCaLocality()
	return _u
}

// SetCaValidityDays sets the "ca_validity_days" field.
func (_u *SelfSignedIssuerUpdate) SetCaValidityDays(v int32) *SelfSignedIssuerUpdate {
	_u.mutation.ResetCaValidityDays()
	_u.mutation.SetCaValidityDays(v)
	return _u
}

// SetNillableCaValidityDays sets the "ca_validity_days" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdate) SetNillableCaValidityDays(v *int32) *SelfSignedIssuerUpdate {
	if v != nil {
		_u.SetCaValidityDays(*v)
	}
	return _u
}

// AddCaValidityDays adds value to the "ca_validity_days" field.
func (_u *SelfSignedIssuerUpdate) AddCaValidityDays(v int32) *SelfSignedIssuerUpdate {
	_u.mutation.AddCaValidityDays(v)
	return _u
}

// SetCaCertificatePem sets the "ca_certificate_pem" field.
func (_u *SelfSignedIssuerUpdate) SetCaCertificatePem(v string) *SelfSignedIssuerUpdate {
	_u.mutation.SetCaCertificatePem(v)
	return _u
}

// SetNillableCaCertificatePem sets the "ca_certificate_pem" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdate) SetNillableCaCertificatePem(v *string) *SelfSignedIssuerUpdate {
	if v != nil {
		_u.SetCaCertificatePem(*v)
	}
	return _u
}

// ClearCaCertificatePem clears the value of the "ca_certificate_pem" field.
func (_u *SelfSignedIssuerUpdate) ClearCaCertificatePem() *SelfSignedIssuerUpdate {
	_u.mutation.ClearCaCertificatePem()
	return _u
}

// SetCaPrivateKeyPem sets the "ca_private_key_pem" field.
func (_u *SelfSignedIssuerUpdate) SetCaPrivateKeyPem(v string) *SelfSignedIssuerUpdate {
	_u.mutation.SetCaPrivateKeyPem(v)
	return _u
}

// SetNillableCaPrivateKeyPem sets the "ca_private_key_pem" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdate) SetNillableCaPrivateKeyPem(v *string) *SelfSignedIssuerUpdate {
	if v != nil {
		_u.SetCaPrivateKeyPem(*v)
	}
	return _u
}

// ClearCaPrivateKeyPem clears the value of the "ca_private_key_pem" field.
func (_u *SelfSignedIssuerUpdate) ClearCaPrivateKeyPem() *SelfSignedIssuerUpdate {
	_u.mutation.ClearCaPrivateKeyPem()
	return _u
}

// SetCaCertificateFingerprint sets the "ca_certificate_fingerprint" field.
func (_u *SelfSignedIssuerUpdate) SetCaCertificateFingerprint(v string) *SelfSignedIssuerUpdate {
	_u.mutation.SetCaCertificateFingerprint(v)
	return _u
}

// SetNillableCaCertificateFingerprint sets the "ca_certificate_fingerprint" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdate) SetNillableCaCertificateFingerprint(v *string) *SelfSignedIssuerUpdate {
	if v != nil {
		_u.SetCaCertificateFingerprint(*v)
	}
	return _u
}

// ClearCaCertificateFingerprint clears the value of the "ca_certificate_fingerprint" field.
func (_u *SelfSignedIssuerUpdate) ClearCaCertificateFingerprint() *SelfSignedIssuerUpdate {
	_u.mutation.ClearCaCertificateFingerprint()
	return _u
}

// SetCaExpiresAt sets the "ca_expires_at" field.
func (_u *SelfSignedIssuerUpdate) SetCaExpiresAt(v time.Time) *SelfSignedIssuerUpdate {
	_u.mutation.SetCaExpiresAt(v)
	return _u
}

// SetNillableCaExpiresAt sets the "ca_expires_at" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdate) SetNillableCaExpiresAt(v *time.Time) *SelfSignedIssuerUpdate {
	if v != nil {
		_u.SetCaExpiresAt(*v)
	}
	return _u
}

// ClearCaExpiresAt clears the value of the "ca_expires_at" field.
func (_u *SelfSignedIssuerUpdate) ClearCaExpiresAt() *SelfSignedIssuerUpdate {
	_u.mutation.ClearCaExpiresAt()
	return _u
}

// SetUpdatedAt sets the "updated_at" field.
func (_u *SelfSignedIssuerUpdate) SetUpdatedAt(v time.Time) *SelfSignedIssuerUpdate {
	_u.mutation.SetUpdatedAt(v)
	return _u
}

// SetIssuerID sets the "issuer" edge to the Issuer entity by ID.
func (_u *SelfSignedIssuerUpdate) SetIssuerID(id uint32) *SelfSignedIssuerUpdate {
	_u.mutation.SetIssuerID(id)
	return _u
}

// SetIssuer sets the "issuer" edge to the Issuer entity.
func (_u *SelfSignedIssuerUpdate) SetIssuer(v *Issuer) *SelfSignedIssuerUpdate {
	return _u.SetIssuerID(v.ID)
}

// Mutation returns the SelfSignedIssuerMutation object of the builder.
func (_u *SelfSignedIssuerUpdate) Mutation() *SelfSignedIssuerMutation {
	return _u.mutation
}

// ClearIssuer clears the "issuer" edge to the Issuer entity.
func (_u *SelfSignedIssuerUpdate) ClearIssuer() *SelfSignedIssuerUpdate {
	_u.mutation.ClearIssuer()
	return _u
}

// Save executes the query and returns the number of nodes affected by the update operation.
func (_u *SelfSignedIssuerUpdate) Save(ctx context.Context) (int, error) {
	_u.defaults()
	return withHooks(ctx, _u.sqlSave, _u.mutation, _u.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (_u *SelfSignedIssuerUpdate) SaveX(ctx context.Context) int {
	affected, err := _u.Save(ctx)
	if err != nil {
		panic(err)
	}
	return affected
}

// Exec executes the query.
func (_u *SelfSignedIssuerUpdate) Exec(ctx context.Context) error {
	_, err := _u.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (_u *SelfSignedIssuerUpdate) ExecX(ctx context.Context) {
	if err := _u.Exec(ctx); err != nil {
		panic(err)
	}
}

// defaults sets the default values of the builder before save.
func (_u *SelfSignedIssuerUpdate) defaults() {
	if _, ok := _u.mutation.UpdatedAt(); !ok {
		v := selfsignedissuer.UpdateDefaultUpdatedAt()
		_u.mutation.SetUpdatedAt(v)
	}
}

// check runs all checks and user-defined validators on the builder.
func (_u *SelfSignedIssuerUpdate) check() error {
	if v, ok := _u.mutation.CommonName(); ok {
		if err := selfsignedissuer.CommonNameValidator(v); err != nil {
			return &ValidationError{Name: "common_name", err: fmt.Errorf(`ent: validator failed for field "SelfSignedIssuer.common_name": %w`, err)}
		}
	}
	if v, ok := _u.mutation.CaCommonName(); ok {
		if err := selfsignedissuer.CaCommonNameValidator(v); err != nil {
			return &ValidationError{Name: "ca_common_name", err: fmt.Errorf(`ent: validator failed for field "SelfSignedIssuer.ca_common_name": %w`, err)}
		}
	}
	if _u.mutation.IssuerCleared() && len(_u.mutation.IssuerIDs()) > 0 {
		return errors.New(`ent: clearing a required unique edge "SelfSignedIssuer.issuer"`)
	}
	return nil
}

// Modify adds a statement modifier for attaching custom logic to the UPDATE statement.
func (_u *SelfSignedIssuerUpdate) Modify(modifiers ...func(u *sql.UpdateBuilder)) *SelfSignedIssuerUpdate {
	_u.modifiers = append(_u.modifiers, modifiers...)
	return _u
}

func (_u *SelfSignedIssuerUpdate) sqlSave(ctx context.Context) (_node int, err error) {
	if err := _u.check(); err != nil {
		return _node, err
	}
	_spec := sqlgraph.NewUpdateSpec(selfsignedissuer.Table, selfsignedissuer.Columns, sqlgraph.NewFieldSpec(selfsignedissuer.FieldID, field.TypeInt))
	if ps := _u.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := _u.mutation.CommonName(); ok {
		_spec.SetField(selfsignedissuer.FieldCommonName, field.TypeString, value)
	}
	if value, ok := _u.mutation.DNSNames(); ok {
		_spec.SetField(selfsignedissuer.FieldDNSNames, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedDNSNames(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, selfsignedissuer.FieldDNSNames, value)
		})
	}
	if _u.mutation.DNSNamesCleared() {
		_spec.ClearField(selfsignedissuer.FieldDNSNames, field.TypeJSON)
	}
	if value, ok := _u.mutation.IPAddresses(); ok {
		_spec.SetField(selfsignedissuer.FieldIPAddresses, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedIPAddresses(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, selfsignedissuer.FieldIPAddresses, value)
		})
	}
	if _u.mutation.IPAddressesCleared() {
		_spec.ClearField(selfsignedissuer.FieldIPAddresses, field.TypeJSON)
	}
	if value, ok := _u.mutation.CaCommonName(); ok {
		_spec.SetField(selfsignedissuer.FieldCaCommonName, field.TypeString, value)
	}
	if value, ok := _u.mutation.CaOrganization(); ok {
		_spec.SetField(selfsignedissuer.FieldCaOrganization, field.TypeString, value)
	}
	if _u.mutation.CaOrganizationCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaOrganization, field.TypeString)
	}
	if value, ok := _u.mutation.CaOrganizationalUnit(); ok {
		_spec.SetField(selfsignedissuer.FieldCaOrganizationalUnit, field.TypeString, value)
	}
	if _u.mutation.CaOrganizationalUnitCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaOrganizationalUnit, field.TypeString)
	}
	if value, ok := _u.mutation.CaCountry(); ok {
		_spec.SetField(selfsignedissuer.FieldCaCountry, field.TypeString, value)
	}
	if _u.mutation.CaCountryCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaCountry, field.TypeString)
	}
	if value, ok := _u.mutation.CaProvince(); ok {
		_spec.SetField(selfsignedissuer.FieldCaProvince, field.TypeString, value)
	}
	if _u.mutation.CaProvinceCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaProvince, field.TypeString)
	}
	if value, ok := _u.mutation.CaLocality(); ok {
		_spec.SetField(selfsignedissuer.FieldCaLocality, field.TypeString, value)
	}
	if _u.mutation.CaLocalityCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaLocality, field.TypeString)
	}
	if value, ok := _u.mutation.CaValidityDays(); ok {
		_spec.SetField(selfsignedissuer.FieldCaValidityDays, field.TypeInt32, value)
	}
	if value, ok := _u.mutation.AddedCaValidityDays(); ok {
		_spec.AddField(selfsignedissuer.FieldCaValidityDays, field.TypeInt32, value)
	}
	if value, ok := _u.mutation.CaCertificatePem(); ok {
		_spec.SetField(selfsignedissuer.FieldCaCertificatePem, field.TypeString, value)
	}
	if _u.mutation.CaCertificatePemCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaCertificatePem, field.TypeString)
	}
	if value, ok := _u.mutation.CaPrivateKeyPem(); ok {
		_spec.SetField(selfsignedissuer.FieldCaPrivateKeyPem, field.TypeString, value)
	}
	if _u.mutation.CaPrivateKeyPemCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaPrivateKeyPem, field.TypeString)
	}
	if value, ok := _u.mutation.CaCertificateFingerprint(); ok {
		_spec.SetField(selfsignedissuer.FieldCaCertificateFingerprint, field.TypeString, value)
	}
	if _u.mutation.CaCertificateFingerprintCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaCertificateFingerprint, field.TypeString)
	}
	if value, ok := _u.mutation.CaExpiresAt(); ok {
		_spec.SetField(selfsignedissuer.FieldCaExpiresAt, field.TypeTime, value)
	}
	if _u.mutation.CaExpiresAtCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaExpiresAt, field.TypeTime)
	}
	if value, ok := _u.mutation.UpdatedAt(); ok {
		_spec.SetField(selfsignedissuer.FieldUpdatedAt, field.TypeTime, value)
	}
	if _u.mutation.IssuerCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: true,
			Table:   selfsignedissuer.IssuerTable,
			Columns: []string{selfsignedissuer.IssuerColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(issuer.FieldID, field.TypeUint32),
			},
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := _u.mutation.IssuerIDs(); len(nodes) > 0 {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: true,
			Table:   selfsignedissuer.IssuerTable,
			Columns: []string{selfsignedissuer.IssuerColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(issuer.FieldID, field.TypeUint32),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Add = append(_spec.Edges.Add, edge)
	}
	_spec.AddModifiers(_u.modifiers...)
	if _node, err = sqlgraph.UpdateNodes(ctx, _u.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{selfsignedissuer.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return 0, err
	}
	_u.mutation.done = true
	return _node, nil
}

// SelfSignedIssuerUpdateOne is the builder for updating a single SelfSignedIssuer entity.
type SelfSignedIssuerUpdateOne struct {
	config
	fields    []string
	hooks     []Hook
	mutation  *SelfSignedIssuerMutation
	modifiers []func(*sql.UpdateBuilder)
}

// SetCommonName sets the "common_name" field.
func (_u *SelfSignedIssuerUpdateOne) SetCommonName(v string) *SelfSignedIssuerUpdateOne {
	_u.mutation.SetCommonName(v)
	return _u
}

// SetNillableCommonName sets the "common_name" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdateOne) SetNillableCommonName(v *string) *SelfSignedIssuerUpdateOne {
	if v != nil {
		_u.SetCommonName(*v)
	}
	return _u
}

// SetDNSNames sets the "dns_names" field.
func (_u *SelfSignedIssuerUpdateOne) SetDNSNames(v []string) *SelfSignedIssuerUpdateOne {
	_u.mutation.SetDNSNames(v)
	return _u
}

// AppendDNSNames appends value to the "dns_names" field.
func (_u *SelfSignedIssuerUpdateOne) AppendDNSNames(v []string) *SelfSignedIssuerUpdateOne {
	_u.mutation.AppendDNSNames(v)
	return _u
}

// ClearDNSNames clears the value of the "dns_names" field.
func (_u *SelfSignedIssuerUpdateOne) ClearDNSNames() *SelfSignedIssuerUpdateOne {
	_u.mutation.ClearDNSNames()
	return _u
}

// SetIPAddresses sets the "ip_addresses" field.
func (_u *SelfSignedIssuerUpdateOne) SetIPAddresses(v []string) *SelfSignedIssuerUpdateOne {
	_u.mutation.SetIPAddresses(v)
	return _u
}

// AppendIPAddresses appends value to the "ip_addresses" field.
func (_u *SelfSignedIssuerUpdateOne) AppendIPAddresses(v []string) *SelfSignedIssuerUpdateOne {
	_u.mutation.AppendIPAddresses(v)
	return _u
}

// ClearIPAddresses clears the value of the "ip_addresses" field.
func (_u *SelfSignedIssuerUpdateOne) ClearIPAddresses() *SelfSignedIssuerUpdateOne {
	_u.mutation.ClearIPAddresses()
	return _u
}

// SetCaCommonName sets the "ca_common_name" field.
func (_u *SelfSignedIssuerUpdateOne) SetCaCommonName(v string) *SelfSignedIssuerUpdateOne {
	_u.mutation.SetCaCommonName(v)
	return _u
}

// SetNillableCaCommonName sets the "ca_common_name" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdateOne) SetNillableCaCommonName(v *string) *SelfSignedIssuerUpdateOne {
	if v != nil {
		_u.SetCaCommonName(*v)
	}
	return _u
}

// SetCaOrganization sets the "ca_organization" field.
func (_u *SelfSignedIssuerUpdateOne) SetCaOrganization(v string) *SelfSignedIssuerUpdateOne {
	_u.mutation.SetCaOrganization(v)
	return _u
}

// SetNillableCaOrganization sets the "ca_organization" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdateOne) SetNillableCaOrganization(v *string) *SelfSignedIssuerUpdateOne {
	if v != nil {
		_u.SetCaOrganization(*v)
	}
	return _u
}

// ClearCaOrganization clears the value of the "ca_organization" field.
func (_u *SelfSignedIssuerUpdateOne) ClearCaOrganization() *SelfSignedIssuerUpdateOne {
	_u.mutation.ClearCaOrganization()
	return _u
}

// SetCaOrganizationalUnit sets the "ca_organizational_unit" field.
func (_u *SelfSignedIssuerUpdateOne) SetCaOrganizationalUnit(v string) *SelfSignedIssuerUpdateOne {
	_u.mutation.SetCaOrganizationalUnit(v)
	return _u
}

// SetNillableCaOrganizationalUnit sets the "ca_organizational_unit" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdateOne) SetNillableCaOrganizationalUnit(v *string) *SelfSignedIssuerUpdateOne {
	if v != nil {
		_u.SetCaOrganizationalUnit(*v)
	}
	return _u
}

// ClearCaOrganizationalUnit clears the value of the "ca_organizational_unit" field.
func (_u *SelfSignedIssuerUpdateOne) ClearCaOrganizationalUnit() *SelfSignedIssuerUpdateOne {
	_u.mutation.ClearCaOrganizationalUnit()
	return _u
}

// SetCaCountry sets the "ca_country" field.
func (_u *SelfSignedIssuerUpdateOne) SetCaCountry(v string) *SelfSignedIssuerUpdateOne {
	_u.mutation.SetCaCountry(v)
	return _u
}

// SetNillableCaCountry sets the "ca_country" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdateOne) SetNillableCaCountry(v *string) *SelfSignedIssuerUpdateOne {
	if v != nil {
		_u.SetCaCountry(*v)
	}
	return _u
}

// ClearCaCountry clears the value of the "ca_country" field.
func (_u *SelfSignedIssuerUpdateOne) ClearCaCountry() *SelfSignedIssuerUpdateOne {
	_u.mutation.ClearCaCountry()
	return _u
}

// SetCaProvince sets the "ca_province" field.
func (_u *SelfSignedIssuerUpdateOne) SetCaProvince(v string) *SelfSignedIssuerUpdateOne {
	_u.mutation.SetCaProvince(v)
	return _u
}

// SetNillableCaProvince sets the "ca_province" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdateOne) SetNillableCaProvince(v *string) *SelfSignedIssuerUpdateOne {
	if v != nil {
		_u.SetCaProvince(*v)
	}
	return _u
}

// ClearCaProvince clears the value of the "ca_province" field.
func (_u *SelfSignedIssuerUpdateOne) ClearCaProvince() *SelfSignedIssuerUpdateOne {
	_u.mutation.ClearCaProvince()
	return _u
}

// SetCaLocality sets the "ca_locality" field.
func (_u *SelfSignedIssuerUpdateOne) SetCaLocality(v string) *SelfSignedIssuerUpdateOne {
	_u.mutation.SetCaLocality(v)
	return _u
}

// SetNillableCaLocality sets the "ca_locality" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdateOne) SetNillableCaLocality(v *string) *SelfSignedIssuerUpdateOne {
	if v != nil {
		_u.SetCaLocality(*v)
	}
	return _u
}

// ClearCaLocality clears the value of the "ca_locality" field.
func (_u *SelfSignedIssuerUpdateOne) ClearCaLocality() *SelfSignedIssuerUpdateOne {
	_u.mutation.ClearCaLocality()
	return _u
}

// SetCaValidityDays sets the "ca_validity_days" field.
func (_u *SelfSignedIssuerUpdateOne) SetCaValidityDays(v int32) *SelfSignedIssuerUpdateOne {
	_u.mutation.ResetCaValidityDays()
	_u.mutation.SetCaValidityDays(v)
	return _u
}

// SetNillableCaValidityDays sets the "ca_validity_days" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdateOne) SetNillableCaValidityDays(v *int32) *SelfSignedIssuerUpdateOne {
	if v != nil {
		_u.SetCaValidityDays(*v)
	}
	return _u
}

// AddCaValidityDays adds value to the "ca_validity_days" field.
func (_u *SelfSignedIssuerUpdateOne) AddCaValidityDays(v int32) *SelfSignedIssuerUpdateOne {
	_u.mutation.AddCaValidityDays(v)
	return _u
}

// SetCaCertificatePem sets the "ca_certificate_pem" field.
func (_u *SelfSignedIssuerUpdateOne) SetCaCertificatePem(v string) *SelfSignedIssuerUpdateOne {
	_u.mutation.SetCaCertificatePem(v)
	return _u
}

// SetNillableCaCertificatePem sets the "ca_certificate_pem" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdateOne) SetNillableCaCertificatePem(v *string) *SelfSignedIssuerUpdateOne {
	if v != nil {
		_u.SetCaCertificatePem(*v)
	}
	return _u
}

// ClearCaCertificatePem clears the value of the "ca_certificate_pem" field.
func (_u *SelfSignedIssuerUpdateOne) ClearCaCertificatePem() *SelfSignedIssuerUpdateOne {
	_u.mutation.ClearCaCertificatePem()
	return _u
}

// SetCaPrivateKeyPem sets the "ca_private_key_pem" field.
func (_u *SelfSignedIssuerUpdateOne) SetCaPrivateKeyPem(v string) *SelfSignedIssuerUpdateOne {
	_u.mutation.SetCaPrivateKeyPem(v)
	return _u
}

// SetNillableCaPrivateKeyPem sets the "ca_private_key_pem" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdateOne) SetNillableCaPrivateKeyPem(v *string) *SelfSignedIssuerUpdateOne {
	if v != nil {
		_u.SetCaPrivateKeyPem(*v)
	}
	return _u
}

// ClearCaPrivateKeyPem clears the value of the "ca_private_key_pem" field.
func (_u *SelfSignedIssuerUpdateOne) ClearCaPrivateKeyPem() *SelfSignedIssuerUpdateOne {
	_u.mutation.ClearCaPrivateKeyPem()
	return _u
}

// SetCaCertificateFingerprint sets the "ca_certificate_fingerprint" field.
func (_u *SelfSignedIssuerUpdateOne) SetCaCertificateFingerprint(v string) *SelfSignedIssuerUpdateOne {
	_u.mutation.SetCaCertificateFingerprint(v)
	return _u
}

// SetNillableCaCertificateFingerprint sets the "ca_certificate_fingerprint" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdateOne) SetNillableCaCertificateFingerprint(v *string) *SelfSignedIssuerUpdateOne {
	if v != nil {
		_u.SetCaCertificateFingerprint(*v)
	}
	return _u
}

// ClearCaCertificateFingerprint clears the value of the "ca_certificate_fingerprint" field.
func (_u *SelfSignedIssuerUpdateOne) ClearCaCertificateFingerprint() *SelfSignedIssuerUpdateOne {
	_u.mutation.ClearCaCertificateFingerprint()
	return _u
}

// SetCaExpiresAt sets the "ca_expires_at" field.
func (_u *SelfSignedIssuerUpdateOne) SetCaExpiresAt(v time.Time) *SelfSignedIssuerUpdateOne {
	_u.mutation.SetCaExpiresAt(v)
	return _u
}

// SetNillableCaExpiresAt sets the "ca_expires_at" field if the given value is not nil.
func (_u *SelfSignedIssuerUpdateOne) SetNillableCaExpiresAt(v *time.Time) *SelfSignedIssuerUpdateOne {
	if v != nil {
		_u.SetCaExpiresAt(*v)
	}
	return _u
}

// ClearCaExpiresAt clears the value of the "ca_expires_at" field.
func (_u *SelfSignedIssuerUpdateOne) ClearCaExpiresAt() *SelfSignedIssuerUpdateOne {
	_u.mutation.ClearCaExpiresAt()
	return _u
}

// SetUpdatedAt sets the "updated_at" field.
func (_u *SelfSignedIssuerUpdateOne) SetUpdatedAt(v time.Time) *SelfSignedIssuerUpdateOne {
	_u.mutation.SetUpdatedAt(v)
	return _u
}

// SetIssuerID sets the "issuer" edge to the Issuer entity by ID.
func (_u *SelfSignedIssuerUpdateOne) SetIssuerID(id uint32) *SelfSignedIssuerUpdateOne {
	_u.mutation.SetIssuerID(id)
	return _u
}

// SetIssuer sets the "issuer" edge to the Issuer entity.
func (_u *SelfSignedIssuerUpdateOne) SetIssuer(v *Issuer) *SelfSignedIssuerUpdateOne {
	return _u.SetIssuerID(v.ID)
}

// Mutation returns the SelfSignedIssuerMutation object of the builder.
func (_u *SelfSignedIssuerUpdateOne) Mutation() *SelfSignedIssuerMutation {
	return _u.mutation
}

// ClearIssuer clears the "issuer" edge to the Issuer entity.
func (_u *SelfSignedIssuerUpdateOne) ClearIssuer() *SelfSignedIssuerUpdateOne {
	_u.mutation.ClearIssuer()
	return _u
}

// Where appends a list predicates to the SelfSignedIssuerUpdate builder.
func (_u *SelfSignedIssuerUpdateOne) Where(ps ...predicate.SelfSignedIssuer) *SelfSignedIssuerUpdateOne {
	_u.mutation.Where(ps...)
	return _u
}

// Select allows selecting one or more fields (columns) of the returned entity.
// The default is selecting all fields defined in the entity schema.
func (_u *SelfSignedIssuerUpdateOne) Select(field string, fields ...string) *SelfSignedIssuerUpdateOne {
	_u.fields = append([]string{field}, fields...)
	return _u
}

// Save executes the query and returns the updated SelfSignedIssuer entity.
func (_u *SelfSignedIssuerUpdateOne) Save(ctx context.Context) (*SelfSignedIssuer, error) {
	_u.defaults()
	return withHooks(ctx, _u.sqlSave, _u.mutation, _u.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (_u *SelfSignedIssuerUpdateOne) SaveX(ctx context.Context) *SelfSignedIssuer {
	node, err := _u.Save(ctx)
	if err != nil {
		panic(err)
	}
	return node
}

// Exec executes the query on the entity.
func (_u *SelfSignedIssuerUpdateOne) Exec(ctx context.Context) error {
	_, err := _u.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (_u *SelfSignedIssuerUpdateOne) ExecX(ctx context.Context) {
	if err := _u.Exec(ctx); err != nil {
		panic(err)
	}
}

// defaults sets the default values of the builder before save.
func (_u *SelfSignedIssuerUpdateOne) defaults() {
	if _, ok := _u.mutation.UpdatedAt(); !ok {
		v := selfsignedissuer.UpdateDefaultUpdatedAt()
		_u.mutation.SetUpdatedAt(v)
	}
}

// check runs all checks and user-defined validators on the builder.
func (_u *SelfSignedIssuerUpdateOne) check() error {
	if v, ok := _u.mutation.CommonName(); ok {
		if err := selfsignedissuer.CommonNameValidator(v); err != nil {
			return &ValidationError{Name: "common_name", err: fmt.Errorf(`ent: validator failed for field "SelfSignedIssuer.common_name": %w`, err)}
		}
	}
	if v, ok := _u.mutation.CaCommonName(); ok {
		if err := selfsignedissuer.CaCommonNameValidator(v); err != nil {
			return &ValidationError{Name: "ca_common_name", err: fmt.Errorf(`ent: validator failed for field "SelfSignedIssuer.ca_common_name": %w`, err)}
		}
	}
	if _u.mutation.IssuerCleared() && len(_u.mutation.IssuerIDs()) > 0 {
		return errors.New(`ent: clearing a required unique edge "SelfSignedIssuer.issuer"`)
	}
	return nil
}

// Modify adds a statement modifier for attaching custom logic to the UPDATE statement.
func (_u *SelfSignedIssuerUpdateOne) Modify(modifiers ...func(u *sql.UpdateBuilder)) *SelfSignedIssuerUpdateOne {
	_u.modifiers = append(_u.modifiers, modifiers...)
	return _u
}

func (_u *SelfSignedIssuerUpdateOne) sqlSave(ctx context.Context) (_node *SelfSignedIssuer, err error) {
	if err := _u.check(); err != nil {
		return _node, err
	}
	_spec := sqlgraph.NewUpdateSpec(selfsignedissuer.Table, selfsignedissuer.Columns, sqlgraph.NewFieldSpec(selfsignedissuer.FieldID, field.TypeInt))
	id, ok := _u.mutation.ID()
	if !ok {
		return nil, &ValidationError{Name: "id", err: errors.New(`ent: missing "SelfSignedIssuer.id" for update`)}
	}
	_spec.Node.ID.Value = id
	if fields := _u.fields; len(fields) > 0 {
		_spec.Node.Columns = make([]string, 0, len(fields))
		_spec.Node.Columns = append(_spec.Node.Columns, selfsignedissuer.FieldID)
		for _, f := range fields {
			if !selfsignedissuer.ValidColumn(f) {
				return nil, &ValidationError{Name: f, err: fmt.Errorf("ent: invalid field %q for query", f)}
			}
			if f != selfsignedissuer.FieldID {
				_spec.Node.Columns = append(_spec.Node.Columns, f)
			}
		}
	}
	if ps := _u.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := _u.mutation.CommonName(); ok {
		_spec.SetField(selfsignedissuer.FieldCommonName, field.TypeString, value)
	}
	if value, ok := _u.mutation.DNSNames(); ok {
		_spec.SetField(selfsignedissuer.FieldDNSNames, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedDNSNames(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, selfsignedissuer.FieldDNSNames, value)
		})
	}
	if _u.mutation.DNSNamesCleared() {
		_spec.ClearField(selfsignedissuer.FieldDNSNames, field.TypeJSON)
	}
	if value, ok := _u.mutation.IPAddresses(); ok {
		_spec.SetField(selfsignedissuer.FieldIPAddresses, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedIPAddresses(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, selfsignedissuer.FieldIPAddresses, value)
		})
	}
	if _u.mutation.IPAddressesCleared() {
		_spec.ClearField(selfsignedissuer.FieldIPAddresses, field.TypeJSON)
	}
	if value, ok := _u.mutation.CaCommonName(); ok {
		_spec.SetField(selfsignedissuer.FieldCaCommonName, field.TypeString, value)
	}
	if value, ok := _u.mutation.CaOrganization(); ok {
		_spec.SetField(selfsignedissuer.FieldCaOrganization, field.TypeString, value)
	}
	if _u.mutation.CaOrganizationCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaOrganization, field.TypeString)
	}
	if value, ok := _u.mutation.CaOrganizationalUnit(); ok {
		_spec.SetField(selfsignedissuer.FieldCaOrganizationalUnit, field.TypeString, value)
	}
	if _u.mutation.CaOrganizationalUnitCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaOrganizationalUnit, field.TypeString)
	}
	if value, ok := _u.mutation.CaCountry(); ok {
		_spec.SetField(selfsignedissuer.FieldCaCountry, field.TypeString, value)
	}
	if _u.mutation.CaCountryCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaCountry, field.TypeString)
	}
	if value, ok := _u.mutation.CaProvince(); ok {
		_spec.SetField(selfsignedissuer.FieldCaProvince, field.TypeString, value)
	}
	if _u.mutation.CaProvinceCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaProvince, field.TypeString)
	}
	if value, ok := _u.mutation.CaLocality(); ok {
		_spec.SetField(selfsignedissuer.FieldCaLocality, field.TypeString, value)
	}
	if _u.mutation.CaLocalityCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaLocality, field.TypeString)
	}
	if value, ok := _u.mutation.CaValidityDays(); ok {
		_spec.SetField(selfsignedissuer.FieldCaValidityDays, field.TypeInt32, value)
	}
	if value, ok := _u.mutation.AddedCaValidityDays(); ok {
		_spec.AddField(selfsignedissuer.FieldCaValidityDays, field.TypeInt32, value)
	}
	if value, ok := _u.mutation.CaCertificatePem(); ok {
		_spec.SetField(selfsignedissuer.FieldCaCertificatePem, field.TypeString, value)
	}
	if _u.mutation.CaCertificatePemCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaCertificatePem, field.TypeString)
	}
	if value, ok := _u.mutation.CaPrivateKeyPem(); ok {
		_spec.SetField(selfsignedissuer.FieldCaPrivateKeyPem, field.TypeString, value)
	}
	if _u.mutation.CaPrivateKeyPemCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaPrivateKeyPem, field.TypeString)
	}
	if value, ok := _u.mutation.CaCertificateFingerprint(); ok {
		_spec.SetField(selfsignedissuer.FieldCaCertificateFingerprint, field.TypeString, value)
	}
	if _u.mutation.CaCertificateFingerprintCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaCertificateFingerprint, field.TypeString)
	}
	if value, ok := _u.mutation.CaExpiresAt(); ok {
		_spec.SetField(selfsignedissuer.FieldCaExpiresAt, field.TypeTime, value)
	}
	if _u.mutation.CaExpiresAtCleared() {
		_spec.ClearField(selfsignedissuer.FieldCaExpiresAt, field.TypeTime)
	}
	if value, ok := _u.mutation.UpdatedAt(); ok {
		_spec.SetField(selfsignedissuer.FieldUpdatedAt, field.TypeTime, value)
	}
	if _u.mutation.IssuerCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: true,
			Table:   selfsignedissuer.IssuerTable,
			Columns: []string{selfsignedissuer.IssuerColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(issuer.FieldID, field.TypeUint32),
			},
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := _u.mutation.IssuerIDs(); len(nodes) > 0 {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: true,
			Table:   selfsignedissuer.IssuerTable,
			Columns: []string{selfsignedissuer.IssuerColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(issuer.FieldID, field.TypeUint32),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Add = append(_spec.Edges.Add, edge)
	}
	_spec.AddModifiers(_u.modifiers...)
	_node = &SelfSignedIssuer{config: _u.config}
	_spec.Assign = _node.assignValues
	_spec.ScanValues = _node.scanValues
	if err = sqlgraph.UpdateNode(ctx, _u.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{selfsignedissuer.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return nil, err
	}
	_u.mutation.done = true
	return _node, nil
}
